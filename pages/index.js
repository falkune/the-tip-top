import React, { useEffect, useState } from "react";
import Head from "next/head";
import Image from "next/image";
import styles from "../styles/Home.module.css";
import tea1 from "../image/tea1.png";
import tea2 from "../image/tea2.png";
import tea3 from "../image/tea3.png";
import tea4 from "../image/tea4.png";
import teab from "../image/teaBingo.png"
import Header from "../component/Header";
import Footer from "../component/Footer";
import { useRouter } from "next/router";
import "animate.css";
import axios from "axios";
import Link from "next/link";
import dayjs from "dayjs"
import "dayjs/locale/fr"
dayjs.locale('fr')


export default function Home() {
  const [num, setNum] = useState(null);
  const [current, setCurrent] = useState("");
  const router = useRouter();

  useEffect(() => {
    console.log("go")
    getCurrent()

  }, []);
  const handleNameChange = (e) => {
    const limit = 10;
    setNum(e.target.value.slice(0, limit));
  };
  const getCurrent = async () => {
    //fonction pour créer un ticket
    const api =
      "https://api.dev.dsp-archiwebo21-ct-df-an-cd.fr/Session/get-current-session";
    try {
      let currenSession = await axios.get(api);
      setCurrent(currenSession.data);
      localStorage.setItem("current", currenSession.data);
      console.log(currenSession.data[0]);
      setCurrent(currenSession.data[0])
    } catch (e) {
      console.log(e);
    }
  };
  const goResult = () => {
      router.push({
        pathname: `connexion`,
        query: { number: num },
      });
  };

  const gift = [
    {
      name: "Coffret 32 euros",
      src: tea1,
      descrition:"Le coffret decouverte est composé de 36 sachets de thé avec 6 mélanges de thés différents.",
      href:"/coffret32"
    },
    {
      name: "Coffret 69 euros",
      src: tea1,
      descrition:"Thé matcha pour maigrir ? En tout cas il est nécessaire de l’accompagner avec un régime alimentaire sain afin d’être en bonne santé et pouvoir profiter de ses vertus.",
      href:"/coffret69"
    },
    {
      name: "100g thé signature",
      src: tea2,
      descrition:"super lot",
      href:"/thesignature"
    },
    {
      name: "100g thé detox",
      src: tea3,
      descrition:"L’infusion au pamplemousse, produit détoxifiant, apporte de nombreux bienfaits pour la santé",
      href:"/thedetox"
    },
    {
      name: "Infuseur à thé",
      src: tea4,
      descrition:"super lot",
      href:"/infuseur"
    },
  ];

  return (
    <div className={styles.main}>
      <Head>
        <title>TeaBingo - Jeux concours</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/fav.png" />
      </Head>
      <Header/>
      <section
        className={styles.homdiv}
        style={{ paddingTop: 50, paddingBottom: 50 }} > 
        <span style={{minWidth:160,width:"12%"}}>
          <Image src={teab}/>
        </span>
        <h1 className={styles.h1}>Jeu concours </h1>
        <Link href="/regle">
         <p style={{textDecoration:"underline",color:"white"}}> Voir les règles de participation</p> 
          </Link>
        {current && <h3 style={{color:"white",margin:5,
        fontSize:"1.4em",
        background:"#02558D",padding:10,paddingLeft:15,paddingRight:15}}>Du {dayjs(current.startDate).format('DD MMMM YYYY')} au  {dayjs(current.endDate).format('DD MMMM YYYY')}</h3> }
        <h2>Tenter de gagner l'un de nos nombreux lots <br></br>
        Des infuseurs ou coffrets spéciaux !
        </h2>
        <button type="button" onClick={goResult} className={styles.action}
          style={{marginBottom:20,marginTop:20}}
        >
            Participer
        </button> 
        <h3 style={{color:"white",margin:5}}> ou </h3>
 <Link href="/lots">
        <button type="button" className={styles.action}
          style={{marginBottom:20,marginTop:20}}
        >
            Voir les lots à gagner
        </button> 
        </Link>
      </section>
    

     
      <Footer />
    </div>
  );
}
