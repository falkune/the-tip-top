import React, { useEffect, useState, useContext } from "react";
import Head from "next/head";
import Image from "next/image";
import styles from "../styles/Home.module.css";
import Header from "../component/Header";
import Footer from "../component/Footer";
import { useRouter } from "next/router";
import Lot from "../component/Lot";
import LoadingScreen from "../component/LoadingScreen";
import tea1 from "../image/tea1.png";
import tea2 from "../image/tea2.png";
import tea3 from "../image/tea3.png";
import tea4 from "../image/tea4.png";
import spin from "../image/spin.gif"
import ApiContext from '../context/apiContext';
import axios from "axios";
import WheelComponent from "react-wheel-of-prizes";
import Modal from "@mui/material/Modal";
import Cookies from "js-cookie";
import ClipLoader from "react-spinners/ClockLoader";



export default function Resultat() {
  const context = useContext(ApiContext)
  const [win, setWin] = useState(false);
  const [loading, setLoading] = useState(true);
  const [lot, setLot] = useState({
    name:"100g thé signature",
    src:tea2,

  });

  const router = useRouter();
  useEffect(() => {
    setTimeout(() => 
    showLot()
        // verifyTicket(router?.query?.number);
    , 2000);
  }, []);

  const showLot = () =>{
    setLoading(false)
    setWin(true)
  }

  const handleClose = () => setWin(false);

  const verifyTicket = async (n) => {
    try {
      let result = context.backend.api.tickets.get('')
      setLot(result.data.lot);
    } catch (e) {
      console.log(e);
    }
  };

  const segments = [
    "Coffret 69 euros",
    "100g thé signature",
    "100g thé detox",
    "Infuseur à thé",
    "Coffrets 39 euros",
  ];

  return (
    <div
      style={{
        backgroundColor: " #38870D",
        width: "100%",
        paddingTop: 100,
        display: "flex",
        flexDirection: "column",
        alignItems: "center",
        height: "100vh",
      }}
    >
      <Head>
        <title>TeaBingo - Jeux concours</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/fav.png" />
      </Head>
      <Header />
      <div
        style={{
          flex: 1,
          display: "flex",
          flexDirection: "column",
          alignItems: "center" }} >

            { loading &&
           <LoadingScreen />  }
          
      </div>
      <Modal
        open={win}
        style={{ border: "none" }}
        onClose={handleClose}
        aria-labelledby="modal-modal-title"
        aria-describedby="modal-modal-description">
        <div
          style={{
            position: "relative",
            display: "flex",
            flexDirection: "column",
            alignItems: "center",
            padding: 15,
            fontSize: 18,
            top: "50%",
            left: "50%",
            transform: "translate(-50%, -50%)",
            width: 350,
            border: "none",
            borderRadius: 8,
            backgroundColor: "white",
            boxShadow: 24,
            textAlign: "center" }} >
          <h2 style={{ color: " #38870D", marginBottom: 0 }}> Vous avez gagné ! </h2>
          <p>{lot.name}</p>
          <Image src={lot.src} />
          <small style={{ color: "grey" }}>
            Rendez-vous dans votre <br></br> magasin pour venir le récuperer
          </small>
          <button
            onClick={handleClose}
            style={{
              width: 180,
              height: 40,
              background: " #38870D",
              color: "white",
              border: "none",
              margin: 15,
              fontSize: 18,
              borderRadius: 5 }}>
            ok
          </button>
        </div>
      </Modal>
      <Footer />
    </div>
  );
}
